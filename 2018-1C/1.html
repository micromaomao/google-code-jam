<!DOCTYPE html><html><head><meta charset="utf8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="../commons/style.css"><script src="../commons/general.js" async></script><title>2018-1C Problem A - Mao's Google Code Jam practice files</title><link rel="stylesheet" href="../commons/hljs.css"></head><body><a class="toroot" href="..">Return to problem list</a><h1>2018-1C Problem A</h1><h2>Final solution</h2><div class="filehead"><div class="fnamecontain"><a class="fname" href="files/cmd.go" target="_blank">cmd.go</a>:</div><a class="download" href="files/cmd.go" title="Download original" download="cmd.go">save</a>&nbsp;&nbsp;&nbsp;<a class="openongithub" href="https://github.com/micromaomao/google-code-jam/blob/master/2018-1C/1/cmd.go" target="_blank">open on GitHub</a></div><pre><code class="hljs"><span class="hljs-comment">// Lesson: the complexity of a tree traversal won't blow up if only valid inputs are traversed. Don't be afraid to</span>
<span class="hljs-comment">// traverse a word tree.</span>
<span class="hljs-comment">// package, import, etc...</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">start</span><span class="hljs-params">()</span></span> {
  <span class="hljs-comment">// read T, repeat test() T times...</span>
}

<span class="hljs-keyword">type</span> Tree <span class="hljs-keyword">struct</span> {
	charId     <span class="hljs-keyword">int</span>
	subTrees   <span class="hljs-keyword">map</span>[<span class="hljs-keyword">int</span>]*Tree
	idsNotUsed <span class="hljs-keyword">map</span>[<span class="hljs-keyword">int</span>]<span class="hljs-keyword">bool</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">newTree</span><span class="hljs-params">(charId <span class="hljs-keyword">int</span>, total <span class="hljs-keyword">int</span>)</span> *<span class="hljs-title">Tree</span></span> {
	idsNotUsed := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-keyword">int</span>]<span class="hljs-keyword">bool</span>)
	<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; total; i++ {
		idsNotUsed[i] = <span class="hljs-literal">true</span>
	}
	<span class="hljs-keyword">return</span> &amp;Tree{charId: charId, subTrees: <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-keyword">int</span>]*Tree), idsNotUsed: idsNotUsed}
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(t *Tree)</span> <span class="hljs-title">find</span><span class="hljs-params">(charId <span class="hljs-keyword">int</span>, nextTotals <span class="hljs-keyword">int</span>)</span> *<span class="hljs-title">Tree</span></span> {
	subt := t.subTrees[charId]
	<span class="hljs-keyword">if</span> subt == <span class="hljs-literal">nil</span> {
		t.subTrees[charId] = newTree(charId, nextTotals)
		<span class="hljs-built_in">delete</span>(t.idsNotUsed, charId)
	}
	<span class="hljs-keyword">return</span> t.subTrees[charId]
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span> {
	<span class="hljs-keyword">var</span> N, L <span class="hljs-keyword">int</span>
	mustReadLineOfInts(&amp;N, &amp;L)
	words := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">string</span>, N)
	<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; N; i++ {
		words[i] = mustReadLine()
		assert(<span class="hljs-built_in">len</span>(words[i]) == L)
	}
	translationTables := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">map</span>[<span class="hljs-keyword">byte</span>]<span class="hljs-keyword">int</span>, L)
	revTranslationTables := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">map</span>[<span class="hljs-keyword">int</span>]<span class="hljs-keyword">byte</span>, L)
	totals := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">int</span>, L)
	<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; L; i++ {
		cnt := <span class="hljs-number">0</span>
		tt := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-keyword">byte</span>]<span class="hljs-keyword">int</span>)
		translationTables[i] = tt
		revTt := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-keyword">int</span>]<span class="hljs-keyword">byte</span>)
		revTranslationTables[i] = revTt
		<span class="hljs-keyword">for</span> j := <span class="hljs-number">0</span>; j &lt; N; j++ {
			char := words[j][i]
			_, existed := tt[char]
			<span class="hljs-keyword">if</span> !existed {
				tt[char] = cnt
				revTt[cnt] = char
				cnt++
			}
		}
		totals[i] = cnt
	}
	t := newTree(<span class="hljs-number">-1</span>, totals[<span class="hljs-number">0</span>])
	<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; N; i++ {
		word := words[i]
		currentT := t
		<span class="hljs-keyword">for</span> j := <span class="hljs-number">0</span>; j &lt; L; j++ {
			char := word[j]
			nextTotal := <span class="hljs-number">0</span>
			<span class="hljs-keyword">if</span> j &lt; L<span class="hljs-number">-1</span> {
				nextTotal = totals[j+<span class="hljs-number">1</span>]
			}
			currentT = currentT.find(translationTables[j][char], nextTotal)
		}
	}

	<span class="hljs-keyword">var</span> trav <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(t *Tree, buf []<span class="hljs-keyword">int</span>)</span> <span class="hljs-title">bool</span></span>
	trav = <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(t *Tree, buf []<span class="hljs-keyword">int</span>)</span> <span class="hljs-title">bool</span></span> {
		<span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(t.idsNotUsed) &gt; <span class="hljs-number">0</span> {
			<span class="hljs-keyword">var</span> oneNotUsedId <span class="hljs-keyword">int</span>
			<span class="hljs-keyword">for</span> id, b := <span class="hljs-keyword">range</span> t.idsNotUsed {
				assert(b)
				oneNotUsedId = id
				<span class="hljs-keyword">break</span>
			}
			buf[<span class="hljs-number">0</span>] = oneNotUsedId
			<span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span>; i &lt; <span class="hljs-built_in">len</span>(buf); i++ {
				buf[i] = <span class="hljs-number">0</span>
			}
			<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(buf) == <span class="hljs-number">1</span> {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
			}
			assert(<span class="hljs-built_in">len</span>(buf) &gt; <span class="hljs-number">1</span>)
			<span class="hljs-keyword">for</span> sid, t := <span class="hljs-keyword">range</span> t.subTrees {
				buf[<span class="hljs-number">0</span>] = sid
				<span class="hljs-keyword">if</span> trav(t, buf[<span class="hljs-number">1</span>:]) {
					<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
				}
			}
			<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
		}
	}

	wordIds := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">int</span>, L)
	<span class="hljs-keyword">if</span> trav(t, wordIds) {
		word := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">byte</span>, L)
		<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; L; i++ {
			word[i] = revTranslationTables[i][wordIds[i]]
		}
		stdout.Write(word)
		stdout.WriteByte(<span class="hljs-string">'\n'</span>)
	} <span class="hljs-keyword">else</span> {
		stdout.WriteString(<span class="hljs-string">"-\n"</span>)
	}
}

<span class="hljs-comment">// boilerplate omitted...</span></code></pre><h2>Sample test cases given in question</h2><div class="filehead"><div class="fnamecontain"><a class="fname" href="files/sample.in" target="_blank">sample.in</a>:</div><a class="download" href="files/sample.in" title="Download original" download="sample.in">save</a>&nbsp;&nbsp;&nbsp;<a class="openongithub" href="https://github.com/micromaomao/google-code-jam/blob/master/2018-1C/1/sample.in" target="_blank">open on GitHub</a></div><pre><code class="hljs">5
4 1
A
B
C
D
4 2
WW
AA
SS
DD
4 2
AA
AB
BA
BB
3 4
CAKE
TORN
SHOW
5 7
HELPIAM
TRAPPED
INSIDEA
CODEJAM
FACTORY</code></pre></body></html>